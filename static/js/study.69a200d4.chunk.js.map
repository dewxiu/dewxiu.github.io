{"version":3,"sources":["utils/storage.js","utils/index.js","views/home/study/index.js"],"names":["getUserInfo","JSON","parse","localStorage","getItem","setUserInfo","userinfo","userInfo","setItem","stringify","removeUserInfo","removeItem","getCollapse","setCollapse","collapse","getActiveTitle","Number","setActiveTitle","id","getViewPos","articleId","posObj","setViewPos","pos","name","percent","rest","curPercent","newObj","removeViewPos","oPosObj","getHistory","setHistory","option","oList","idx","findIndex","item","splice","list","removeHistory","newList","filter","clearHistory","isPc","navigator","userAgent","match","getURLParameters","url","reduce","a","v","val","decodeURIComponent","slice","indexOf","throttle","func","delay","prev","Date","now","args","call","rangeRandom","start","end","parseInt","Math","random","formatDate","d","format","date","paddNum","num","replace","cfg","yyyy","getFullYear","yy","toString","substring","M","getMonth","MM","getDate","dd","hh","getHours","mm","getMinutes","ss","getSeconds","m","Study","history","useHistory","userHistory","useState","historyList","setHistoryList","showButton","setShowButton","useEffect","onJump","push","link","onSearch","e","value","target","x","f","title","onCancel","onDelete","Dialog","confirm","content","onClear","onRefresh","sleep","extra","color","size","onClick","style","margin","className","placeholder","onBlur","showCancelButton","length","height","description","minHeight","map","index","p","key","closeOnAction","rightActions","text","Item","bind","padding","fontWeight","lineHeight","cate","time"],"mappings":"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","file":"static/js/study.69a200d4.chunk.js","sourcesContent":["const __userinfo = \"__userinfo__\";\nconst __collapse = \"__collapse__\";\nconst __activeKey = \"__activeKey__\";\nconst __view_pos = \"__view_pos__\";\nconst __history = \"__history__\";\n\n/** ==================== 保存用户名和密码 ==================== */\nexport const getUserInfo = () => JSON.parse(localStorage.getItem(__userinfo) || \"{}\");\nexport const setUserInfo = (userinfo) => {\n  const userInfo = getUserInfo();\n  localStorage.setItem(__userinfo, JSON.stringify({ ...userInfo, ...userinfo }));\n};\nexport const removeUserInfo = () => localStorage.removeItem(__userinfo);\n\n/** ==================== 保存菜单展开 ==================== */\nexport const getCollapse = () => localStorage.getItem(__collapse) || null;\nexport const setCollapse = (collapse) => {\n  const col = localStorage.setItem(__collapse, collapse);\n  return col;\n};\n\nexport const removeCollapse = () => localStorage.removeItem(__collapse);\n\n/** ==================== 保存点击的文章id ==================== */\nexport const getActiveTitle = () => Number(localStorage.getItem(__activeKey));\nexport const setActiveTitle = (id) => localStorage.setItem(__activeKey, id);\nexport const removeActiveTitle = () => localStorage.removeItem(__activeKey);\n\n/** ==================== 保存浏览位置 ==================== */\nexport const getViewPos = (articleId) => {\n  const posObj = JSON.parse(localStorage.getItem(__view_pos) || \"{}\");\n  const res = articleId ? posObj[articleId] : posObj;\n  return res;\n};\n\nexport const setViewPos = ({ id, pos, name, percent, ...rest }) => {\n  const posObj = getViewPos();\n  let curPercent = posObj.percent || 0;\n  if (percent > curPercent) curPercent = percent;\n\n  const newObj = {\n    ...posObj,\n    [id]: { pos, name, ...rest, percent: curPercent },\n  };\n  localStorage.setItem(__view_pos, JSON.stringify(newObj));\n};\n\nexport const removeViewPos = (id) => {\n  // localStorage.removeItem(__view_pos);\n  const oPosObj = getViewPos();\n  delete oPosObj[id];\n  localStorage.setItem(__view_pos, JSON.stringify(oPosObj));\n};\n\n/** ==================== 存储浏览历史 ==================== */\nexport const getHistory = () => {\n  const oList = JSON.parse(localStorage.getItem(__history) || \"[]\");\n  return oList;\n};\n\nexport const setHistory = (option) => {\n  const oList = getHistory();\n  const idx = oList.findIndex((item) => item.id === option.id);\n  if (idx > -1) {\n    oList.splice(idx, 1);\n  }\n  const list = [option, ...oList];\n  localStorage.setItem(__history, JSON.stringify(list));\n};\n\nexport const removeHistory = (id) => {\n  const oList = getHistory();\n  const newList = oList.filter((item) => item.id !== id);\n  localStorage.setItem(__history, JSON.stringify(newList));\n  return newList;\n};\nexport const clearHistory = () => localStorage.removeItem(__history);\n","/**\n * 工具方法\n */\n/** 判断是否PC端 */\nexport const isPc = () => {\n  const reg =\n    /phone|pad|pod|iPhone|iPod|ios|iPad|Anddroid|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone/;\n  if (navigator.userAgent.match(reg)) {\n    return \"Mobile\";\n  } else {\n    return \"PC\";\n  }\n};\n/** 获取地址栏参数 */\nexport const getURLParameters = (url) => {\n  const params = url.match(/([^?=&]+)(=([^&]*))/g) || [];\n  const res = params.reduce((a, v) => {\n    const val = decodeURIComponent(v.slice(v.indexOf(\"=\") + 1));\n    a[v.slice(0, v.indexOf(\"=\"))] = val;\n    return a;\n  }, {});\n  return res;\n};\n\n/** 函数节流 */\nexport const throttle = (func, delay = 120) => {\n  let prev = Date.now();\n  return (...args) => {\n    const now = Date.now();\n    if (now - prev >= delay) {\n      func.call(null, ...args);\n      prev = Date.now();\n    }\n  };\n};\n\n/** 函数防抖 */\nexport const debounce = (func, wait = 120) => {\n  let timer = null;\n  return (...args) => {\n    if (timer !== null) clearTimeout(timer);\n    timer = setTimeout(func.bind(null, ...args), wait);\n  };\n};\n\n/** 范围随机 */\nexport const rangeRandom = (start, end) => {\n  return parseInt(Math.random() * (start - end + 1) + end);\n};\n\nexport const formatDate = (d, format) => {\n  const date = new Date(d);\n  var paddNum = function (num) {\n    num += \"\";\n    return num.replace(/^(\\d)$/, \"0$1\");\n  };\n  // 指定格式字符\n  var cfg = {\n    yyyy: date.getFullYear(), // 年 : 4位\n    yy: date.getFullYear().toString().substring(2), // 年 : 2位\n    M: paddNum(date.getMonth() + 1), // 月 : 如果1位的时候不补0\n    MM: paddNum(date.getMonth() + 1), // 月 : 如果1位的时候补0\n    d: paddNum(date.getDate()), // 日 : 如果1位的时候不补0\n    dd: paddNum(date.getDate()), // 日 : 如果1位的时候补0\n    hh: paddNum(date.getHours()), // 时\n    mm: paddNum(date.getMinutes()), // 分\n    ss: paddNum(date.getSeconds()), // 秒\n  };\n  format || (format = \"yyyy-MM-dd hh:mm:ss\");\n  return format.replace(/([a-z])(\\1)*/gi, function (m) {\n    return cfg[m];\n  });\n};\n","import { Button, Card, Dialog, Empty, List, ProgressCircle, PullToRefresh, SearchBar, SwipeAction } from \"antd-mobile\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { clearHistory, getHistory, getViewPos, removeHistory, removeViewPos } from \"../../../utils/storage\";\r\nimport { formatDate, throttle } from \"../../../utils\";\r\n\r\nimport { sleep } from \"antd-mobile/es/utils/sleep\";\r\nimport { useHistory } from \"react-router\";\r\n\r\nconst Study = () => {\r\n  const history = useHistory();\r\n  const userHistory = getHistory();\r\n  const [historyList, setHistoryList] = useState(() => userHistory);\r\n  const [showButton, setShowButton] = useState(true);\r\n  useEffect(() => {\r\n    setShowButton(true);\r\n  }, []);\r\n\r\n  const onJump = (item) => {\r\n    history.push(item.link);\r\n  };\r\n  const onSearch = throttle((e) => {\r\n    const value = e.target.value;\r\n    setHistoryList((x) => {\r\n      setShowButton(false);\r\n      return x.filter((f) => {\r\n        const s = (f.name && f.name.indexOf(value) > -1) || (f.title && f.title.indexOf(value) > -1);\r\n        return s;\r\n      });\r\n    });\r\n  }, 2000);\r\n\r\n  const onCancel = (e) => {\r\n    setHistoryList(userHistory);\r\n  };\r\n\r\n  const onDelete = async (item) => {\r\n    const res = await Dialog.confirm({ content: \"确认删除吗?\" });\r\n    if (res) {\r\n      removeHistory(item.id);\r\n      setHistoryList((x) => x.filter((f) => f.id !== item.id));\r\n      removeViewPos(item.id);\r\n    }\r\n  };\r\n\r\n  const onStart = () => {\r\n    history.push(\"/home/index\");\r\n  };\r\n\r\n  const onClear = async () => {\r\n    const res = await Dialog.confirm({ content: \"确认清空历史记录吗?\" });\r\n    if (res) {\r\n      setHistoryList([]);\r\n      clearHistory();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <PullToRefresh\r\n        onRefresh={async () => {\r\n          await sleep(1000);\r\n          setHistoryList(getHistory());\r\n        }}\r\n      >\r\n        <Card\r\n          title=\"历史记录\"\r\n          extra={\r\n            <Button color=\"danger\" size=\"small\" onClick={onClear}>\r\n              清空历史\r\n            </Button>\r\n          }\r\n        >\r\n          <div style={{ margin: \"5px 0 10px\" }} className=\"flex just-between\">\r\n            <SearchBar\r\n              placeholder=\"请输入内容\"\r\n              onSearch={onSearch}\r\n              onBlur={onSearch}\r\n              onClear={onCancel}\r\n              onCancel={onCancel}\r\n              className=\"flex-1\"\r\n              showCancelButton={() => true}\r\n            />\r\n          </div>\r\n          {historyList.length === 0 ? (\r\n            <div className=\"flex-col align-center just-center\" style={{ height: \"70%\" }}>\r\n              <Empty description=\"暂无学习记录~\" />\r\n              {showButton ? (\r\n                <div className=\"ui-ta-c\">\r\n                  <Button color=\"primary\" className=\"mt20\" onClick={onStart}>\r\n                    开始学习\r\n                  </Button>\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n          ) : (\r\n            <List\r\n              style={{\r\n                minHeight: \"100vh\",\r\n                \"--padding-left\": 0,\r\n                \"--padding-right\": 0,\r\n              }}\r\n            >\r\n              {historyList.map((item, index) => {\r\n                const p = getViewPos(item.id);\r\n                const percent = p ? p.percent : 0;\r\n                return (\r\n                  <SwipeAction\r\n                    key={item.id}\r\n                    closeOnAction={false}\r\n                    rightActions={[{ key: \"delete\", text: \"删除\", color: \"danger\", onClick: () => onDelete(item) }]}\r\n                  >\r\n                    <List.Item key={index}>\r\n                      <div onClick={onJump.bind(null, item)}>\r\n                        <div className=\"flex just-between align-center\">\r\n                          <div className=\"flex-1 ui-ov-h mr10\">\r\n                            <h4 style={{ padding: 0 }} className=\"ellipsis\">\r\n                              {item.title}\r\n                            </h4>\r\n                            <h6 style={{ fontWeight: 400 }} className=\"flex-1 fz14  ellipsis\">\r\n                              {item.name}\r\n                            </h6>\r\n                          </div>\r\n                          <ProgressCircle percent={percent} style={{ \"--size\": \"40px\" }}>\r\n                            <span className=\"fz12\" style={{ lineHeight: 40 }}>\r\n                              {percent}%\r\n                            </span>\r\n                          </ProgressCircle>\r\n                        </div>\r\n                        <div className=\"flex just-between mt5\">\r\n                          <div className=\"fz12\" style={{ color: item.cate === \"简答题\" ? \"#f60\" : \"#3134eb\" }}>\r\n                            {item.cate}\r\n                          </div>\r\n                          <div className=\"word-nowrap fz12\" style={{ color: \"#99a2aa\" }}>\r\n                            {formatDate(item.time)}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </List.Item>\r\n                  </SwipeAction>\r\n                );\r\n              })}\r\n            </List>\r\n          )}\r\n        </Card>\r\n      </PullToRefresh>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Study;\r\n"],"sourceRoot":""}